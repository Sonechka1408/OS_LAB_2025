# Лабораторная работа №4

## Структура проекта

```
new_lab4/
├── src/
│   ├── parallel_min_max.c    # Задание 1: parallel_min_max с таймаутом
│   ├── zombie_process.c       # Задание 2: демонстрация зомби-процессов
│   ├── process_memory.c       # Задание 3: демонстрация виртуальной памяти
│   ├── parallel_sum.c         # Задание 5: параллельное суммирование массива
│   ├── sum.h, sum.c           # Библиотека для суммирования
│   ├── find_min_max.h, find_min_max.c  # Функции поиска min/max
│   ├── utils.h, utils.c       # Утилиты (GenerateArray)
│   ├── Makefile               # Makefile для заданий 1 и 3
│   └── Makefile.sum           # Makefile для задания 5
└── README.md
```

## Компиляция и запуск

### Задание 1: parallel_min_max с таймаутом

```bash
cd src
make -f Makefile parallel_min_max
./parallel_min_max --seed 123 --array_size 1000 --pnum 4 --timeout 5
```

Параметр `--timeout` необязателен. Если он задан, то после указанного времени (в секундах) родительский процесс отправит дочерним процессам сигнал SIGKILL.

### Задание 2: Демонстрация зомби-процессов

```bash
gcc -o zombie_process zombie_process.c
./zombie_process
```

Во время выполнения программы в другом терминале можно проверить наличие зомби-процессов:
```bash
ps aux | grep zombie_process
ps -eo pid,stat,comm | grep Z
```

### Задание 3: process_memory

```bash
cd src
make -f Makefile process_memory
./process_memory
```

**Объяснение переменных etext, edata, end:**

- **etext**: Адрес конца сегмента текста (кода). Символизирует границу между кодом программы и данными.
- **edata**: Адрес конца сегмента инициализированных данных. Разделяет инициализированные и неинициализированные глобальные/статические переменные.
- **end**: Адрес конца сегмента данных (BSS - Block Started by Symbol). Разделяет неинициализированные статические данные и область кучи (heap).

Эти переменные позволяют понять структуру виртуальной памяти процесса:
- Текст (код): от начала до `etext`
- Инициализированные данные: от `etext` до `edata`
- Неинициализированные данные (BSS): от `edata` до `end`
- Куча (heap): после `end` (растет вверх)
- Стек: в высоких адресах (растет вниз)

### Задание 5: parallel_sum

```bash
cd src
make -f Makefile.sum
./parallel_sum --threads_num 4 --seed 123 --array_size 1000000
```

Программа суммирует массив параллельно используя pthread, выводит общую сумму и время выполнения (генерация массива не учитывается во времени).

## Описание заданий

### Задание 1: Таймаут для дочерних процессов

Программа `parallel_min_max.c` дополнена функционалом таймаута:
- Использует `alarm()` и обработчик сигнала `SIGALRM`
- Хранит PIDs всех дочерних процессов
- При истечении таймаута отправляет `SIGKILL` всем дочерним процессам
- Использует неблокирующий `waitpid()` с флагом `WNOHANG`

### Задание 2: Зомби-процессы

Программа `zombie_process.c` демонстрирует:
- Как создаются зомби-процессы (дочерний завершается, родитель не вызывает wait)
- Как от них избавиться (вызвать wait/waitpid)
- В программе есть подробные комментарии с объяснениями

### Задание 3: Виртуальная память

Программа `process_memory.c` показывает адреса различных частей процесса:
- Кода (функций)
- Статических переменных
- Автоматических переменных
- Динамически выделенной памяти

### Задание 5: Параллельное суммирование

Программа `parallel_sum.c`:
- Использует POSIX threads для параллельного суммирования массива
- Функция `Sum` вынесена в отдельную библиотеку (`sum.c`, `sum.h`)
- Принимает аргументы: количество потоков, seed, размер массива
- Измеряет время выполнения (без учета генерации массива)

## Очистка

```bash
# Очистка файлов от заданий 1 и 3
make -f Makefile clean

# Очистка файлов от задания 5
make -f Makefile.sum clean
```


